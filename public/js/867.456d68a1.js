"use strict";(self["webpackChunkMoois"]=self["webpackChunkMoois"]||[]).push([[867],{6867:function(e,t,s){s.r(t),s.d(t,{default:function(){return N}});var n=s(6768),i=s(4232);const o={key:0,class:"eventButton deleteIcon"},a=["id"];function r(e,t,s,r,l,d){const c=(0,n.g2)("addEvent"),h=(0,n.g2)("Filter"),u=(0,n.g2)("FullCalendar"),g=(0,n.gN)("long-press");return(0,n.uX)(),(0,n.CE)(n.FK,null,[this.isAddEventVisible?((0,n.uX)(),(0,n.Wv)(c,{key:0,onClose:this.toggleAddEvent},null,8,["onClose"])):(0,n.Q3)("",!0),this.isFilterVisible?((0,n.uX)(),(0,n.Wv)(h,{key:1,onClose:this.toggleFilter},null,8,["onClose"])):(0,n.Q3)("",!0),(0,n.bF)(u,{class:"listView",ref:"fullCalendar",options:l.calendarOptions},{eventContent:(0,n.k6)(e=>[(0,n.Lk)("div",{class:(0,i.C4)(["event",e.event.extendedProps.color])},[(0,n.Lk)("div",{class:(0,i.C4)(["eventTitle",e.event.extendedProps.status])},(0,i.v_)(e.event.title),3),"true"===e.event.extendedProps.userAdded&&l.isDelete?((0,n.uX)(),(0,n.CE)("div",o)):"done"!==e.event.extendedProps.status?(0,n.bo)(((0,n.uX)(),(0,n.CE)("div",{key:1,id:e.event.id,class:"eventButton highlightIcon","on:onLongPress":t[0]||(t[0]=(...e)=>d.onLongPress&&d.onLongPress(...e))},null,40,a)),[[g]]):(0,n.Q3)("",!0)],2)]),_:1},8,["options"])],64)}s(4114),s(8111),s(1701),s(3579);var l=s(3535),d=s(4273),c=s(6730),h=s(9403),u=s(7533);class g extends h.B{constructor(){super(...arguments),this.state={textId:(0,h.a3)()}}render(){let{theme:e,dateEnv:t,options:s,viewApi:n}=this.context,{cellId:i,dayDate:o,todayRange:a}=this.props,{textId:r}=this.state,l=(0,h.aY)(o,a),d=s.listDayFormat?t.format(o,s.listDayFormat):"",c=s.listDaySideFormat?t.format(o,s.listDaySideFormat):"",g=Object.assign({date:t.toDate(o),view:n,textId:r,text:d,sideText:c,navLinkAttrs:(0,h.a_)(this.context,o),sideNavLinkAttrs:(0,h.a_)(this.context,o,"day",!1)},l);return(0,u.n)(h.C,{elTag:"tr",elClasses:["fc-list-day",...(0,h.aX)(l,e)],elAttrs:{"data-date":(0,h.bt)(o)},renderProps:g,generatorName:"dayHeaderContent",customGenerator:s.dayHeaderContent,defaultGenerator:v,classNameGenerator:s.dayHeaderClassNames,didMount:s.dayHeaderDidMount,willUnmount:s.dayHeaderWillUnmount},t=>(0,u.n)("th",{scope:"colgroup",colSpan:3,id:i,"aria-labelledby":r},(0,u.n)(t,{elTag:"div",elClasses:["fc-list-day-cushion",e.getClass("tableCellShaded")]})))}}function v(e){return(0,u.n)(u.FK,null,e.text&&(0,u.n)("a",Object.assign({id:e.textId,className:"fc-list-day-text"},e.navLinkAttrs),e.text),e.sideText&&(0,u.n)("a",Object.assign({"aria-hidden":!0,className:"fc-list-day-side-text"},e.sideNavLinkAttrs),e.sideText))}const f=(0,h.x)({hour:"numeric",minute:"2-digit",meridiem:"short"});class p extends h.B{render(){let{props:e,context:t}=this,{options:s}=t,{seg:n,timeHeaderId:i,eventHeaderId:o,dateHeaderId:a}=e,r=s.eventTimeFormat||f;return(0,u.n)(h.ck,Object.assign({},e,{elTag:"tr",elClasses:["fc-list-event",n.eventRange.def.url&&"fc-event-forced-url"],defaultGenerator:()=>m(n,t),seg:n,timeText:"",disableDragging:!0,disableResizing:!0}),(e,s)=>(0,u.n)(u.FK,null,y(n,r,t,i,a),(0,u.n)("td",{"aria-hidden":!0,className:"fc-list-event-graphic"},(0,u.n)("span",{className:"fc-list-event-dot",style:{borderColor:s.borderColor||s.backgroundColor}})),(0,u.n)(e,{elTag:"td",elClasses:["fc-list-event-title"],elAttrs:{headers:`${o} ${a}`}})))}}function m(e,t){let s=(0,h.bS)(e,t);return(0,u.n)("a",Object.assign({},s),e.eventRange.def.title)}function y(e,t,s,n,i){let{options:o}=s;if(!1!==o.displayEventTime){let a,r=e.eventRange.def,l=e.eventRange.instance,d=!1;if(r.allDay?d=!0:(0,h.ax)(e.eventRange.range)?e.isStart?a=(0,h.bO)(e,t,s,null,null,l.range.start,e.end):e.isEnd?a=(0,h.bO)(e,t,s,null,null,e.start,l.range.end):d=!0:a=(0,h.bO)(e,t,s),d){let e={text:s.options.allDayText,view:s.viewApi};return(0,u.n)(h.C,{elTag:"td",elClasses:["fc-list-event-time"],elAttrs:{headers:`${n} ${i}`},renderProps:e,generatorName:"allDayContent",customGenerator:o.allDayContent,defaultGenerator:b,classNameGenerator:o.allDayClassNames,didMount:o.allDayDidMount,willUnmount:o.allDayWillUnmount})}return(0,u.n)("td",{className:"fc-list-event-time"},a)}return null}function b(e){return e.text}class x extends h.bc{constructor(){super(...arguments),this.computeDateVars=(0,h.z)(E),this.eventStoreToSegs=(0,h.z)(this._eventStoreToSegs),this.state={timeHeaderId:(0,h.a3)(),eventHeaderId:(0,h.a3)(),dateHeaderIdRoot:(0,h.a3)()},this.setRootEl=e=>{e?this.context.registerInteractiveComponent(this,{el:e}):this.context.unregisterInteractiveComponent(this)}}render(){let{props:e,context:t}=this,{dayDates:s,dayRanges:n}=this.computeDateVars(e.dateProfile),i=this.eventStoreToSegs(e.eventStore,e.eventUiBases,n);return(0,u.n)(h.cq,{elRef:this.setRootEl,elClasses:["fc-list",t.theme.getClass("table"),!1!==t.options.stickyHeaderDates?"fc-list-sticky":""],viewSpec:t.viewSpec},(0,u.n)(h.cb,{liquid:!e.isHeightAuto,overflowX:e.isHeightAuto?"visible":"hidden",overflowY:e.isHeightAuto?"visible":"auto"},i.length>0?this.renderSegList(i,s):this.renderEmptyMessage()))}renderEmptyMessage(){let{options:e,viewApi:t}=this.context,s={text:e.noEventsText,view:t};return(0,u.n)(h.C,{elTag:"div",elClasses:["fc-list-empty"],renderProps:s,generatorName:"noEventsContent",customGenerator:e.noEventsContent,defaultGenerator:w,classNameGenerator:e.noEventsClassNames,didMount:e.noEventsDidMount,willUnmount:e.noEventsWillUnmount},e=>(0,u.n)(e,{elTag:"div",elClasses:["fc-list-empty-cushion"]}))}renderSegList(e,t){let{theme:s,options:n}=this.context,{timeHeaderId:i,eventHeaderId:o,dateHeaderIdRoot:a}=this.state,r=C(e);return(0,u.n)(h.a6,{unit:"day"},(e,l)=>{let d=[];for(let s=0;s<r.length;s+=1){let c=r[s];if(c){let r=(0,h.bt)(t[s]),v=a+"-"+r;d.push((0,u.n)(g,{key:r,cellId:v,dayDate:t[s],todayRange:l})),c=(0,h.bP)(c,n.eventOrder);for(let t of c)d.push((0,u.n)(p,Object.assign({key:r+":"+t.eventRange.instance.instanceId,seg:t,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:!1,timeHeaderId:i,eventHeaderId:o,dateHeaderId:v},(0,h.bQ)(t,l,e))))}}return(0,u.n)("table",{className:"fc-list-table "+s.getClass("table")},(0,u.n)("thead",null,(0,u.n)("tr",null,(0,u.n)("th",{scope:"col",id:i},n.timeHint),(0,u.n)("th",{scope:"col","aria-hidden":!0}),(0,u.n)("th",{scope:"col",id:o},n.eventHint))),(0,u.n)("tbody",null,d))})}_eventStoreToSegs(e,t,s){return this.eventRangesToSegs((0,h.ad)(e,t,this.props.dateProfile.activeRange,this.context.options.nextDayThreshold).fg,s)}eventRangesToSegs(e,t){let s=[];for(let n of e)s.push(...this.eventRangeToSegs(n,t));return s}eventRangeToSegs(e,t){let s,n,i,{dateEnv:o}=this.context,{nextDayThreshold:a}=this.context.options,r=e.range,l=e.def.allDay,d=[];for(s=0;s<t.length;s+=1)if(n=(0,h.o)(r,t[s]),n&&(i={component:this,eventRange:e,start:n.start,end:n.end,isStart:e.isStart&&n.start.valueOf()===r.start.valueOf(),isEnd:e.isEnd&&n.end.valueOf()===r.end.valueOf(),dayIndex:s},d.push(i),!i.isEnd&&!l&&s+1<t.length&&r.end<o.add(t[s+1].start,a))){i.end=r.end,i.isEnd=!0;break}return d}}function w(e){return e.text}function E(e){let t=(0,h.q)(e.renderRange.start),s=e.renderRange.end,n=[],i=[];while(t<s)n.push(t),i.push({start:t,end:(0,h.t)(t,1)}),t=(0,h.t)(t,1);return{dayDates:n,dayRanges:i}}function C(e){let t,s,n=[];for(t=0;t<e.length;t+=1)s=e[t],(n[s.dayIndex]||(n[s.dayIndex]=[])).push(s);return n}var S=':root{--fc-list-event-dot-width:10px;--fc-list-event-hover-bg-color:#f5f5f5}.fc-theme-standard .fc-list{border:1px solid var(--fc-border-color)}.fc .fc-list-empty{align-items:center;background-color:var(--fc-neutral-bg-color);display:flex;height:100%;justify-content:center}.fc .fc-list-empty-cushion{margin:5em 0}.fc .fc-list-table{border-style:hidden;width:100%}.fc .fc-list-table tr>*{border-left:0;border-right:0}.fc .fc-list-sticky .fc-list-day>*{background:var(--fc-page-bg-color);position:sticky;top:0}.fc .fc-list-table thead{left:-10000px;position:absolute}.fc .fc-list-table tbody>tr:first-child th{border-top:0}.fc .fc-list-table th{padding:0}.fc .fc-list-day-cushion,.fc .fc-list-table td{padding:8px 14px}.fc .fc-list-day-cushion:after{clear:both;content:"";display:table}.fc-theme-standard .fc-list-day-cushion{background-color:var(--fc-neutral-bg-color)}.fc-direction-ltr .fc-list-day-text,.fc-direction-rtl .fc-list-day-side-text{float:left}.fc-direction-ltr .fc-list-day-side-text,.fc-direction-rtl .fc-list-day-text{float:right}.fc-direction-ltr .fc-list-table .fc-list-event-graphic{padding-right:0}.fc-direction-rtl .fc-list-table .fc-list-event-graphic{padding-left:0}.fc .fc-list-event.fc-event-forced-url{cursor:pointer}.fc .fc-list-event:hover td{background-color:var(--fc-list-event-hover-bg-color)}.fc .fc-list-event-graphic,.fc .fc-list-event-time{white-space:nowrap;width:1px}.fc .fc-list-event-dot{border:calc(var(--fc-list-event-dot-width)/2) solid var(--fc-event-border-color);border-radius:calc(var(--fc-list-event-dot-width)/2);box-sizing:content-box;display:inline-block;height:0;width:0}.fc .fc-list-event-title a{color:inherit;text-decoration:none}.fc .fc-list-event.fc-event-forced-url:hover a{text-decoration:underline}';(0,h.ct)(S);const D={listDayFormat:k,listDaySideFormat:k,noEventsClassNames:h.n,noEventsContent:h.n,noEventsDidMount:h.n,noEventsWillUnmount:h.n};function k(e){return!1===e?null:(0,h.x)(e)}var T=(0,c.i1)({name:"@fullcalendar/list",optionRefiners:D,views:{list:{component:x,buttonTextKey:"list",listDayFormat:{month:"long",day:"numeric",year:"numeric"}},listDay:{type:"list",duration:{days:1},listDayFormat:{weekday:"long"}},listWeek:{type:"list",duration:{weeks:1},listDayFormat:{weekday:"long"},listDaySideFormat:{month:"long",day:"numeric",year:"numeric"}},listMonth:{type:"list",duration:{month:1},listDaySideFormat:{weekday:"long"}},listYear:{type:"list",duration:{year:1},listDaySideFormat:{weekday:"long"}}}});const L=["mousedown","touchstart"],I=["mouseup","mouseleave","touchend"],A=500,F={mounted(e){let t=null;const s=s=>{"mousedown"===s.type&&0!==s.button||(t=setTimeout(()=>{e.dispatchEvent(new CustomEvent("onLongPress",{detail:s}))},A))},n=e=>{t&&(clearTimeout(t),t=null)};L.forEach(t=>e.addEventListener(t,s,{passive:!0})),I.forEach(t=>e.addEventListener(t,n,{passive:!0})),e._cleanup=()=>{L.forEach(t=>e.removeEventListener(t,s)),I.forEach(t=>e.removeEventListener(t,n))}},unmounted(e){e._cleanup()}};var R=s(4578),P=s(9325),H={name:"kodutood",components:{FullCalendar:l.A,addEvent:(0,n.$V)(()=>s.e(420).then(s.bind(s,4420))),Filter:(0,n.$V)(()=>s.e(515).then(s.bind(s,3515)))},directives:{longPress:F},data(){return{isAddEventVisible:!1,isFilterVisible:!1,isLongPress:!1,isDelete:!1,highlightColor:localStorage.getItem("high")&&/(red|orange|yellow)/.test(localStorage.getItem("high"))?localStorage.getItem("high"):"red",calendarOptions:{plugins:[T],customButtons:{trash:{text:"Kustuta",icon:"trash",click:this.toggleDelete},addEvent:{text:"Lisa",icon:"addEvent",click:this.toggleAddEvent},filter:{text:"Filter",icon:"filter",click:this.toggleFilter},tunniplaan:{text:"Tunniplaan",click:this.changeView},settings:{text:"Seaded",icon:"settings ",click:this.showSettings}},views:{kodutood:{type:"list"}},locale:d.A,defaultTimedEventDuration:0,events:this.getEvents,lazyFetching:!0,progressiveEventRendering:!0,contentHeight:"auto",initialView:"kodutood",eventsSet:this.setVisibleRange,eventClick:this.onEventClick,headerToolbar:{left:"",center:"",right:"filter addEvent trash tunniplaan settings"}}}},methods:{setVisibleRange(e){if(0===e.length)return;const t=e.map(e=>new Date(new Date(e.start).toISOString().split("T")[0])),s=new Date(Math.min(...t));let n=new Date(Math.max(...t));n.setDate(n.getDate()+2),this.calendar.setOption("visibleRange",{start:s.toISOString().split("T")[0],end:n.toISOString().split("T")[0]})},onEventClick(e){const{event:t,jsEvent:s}=e,n=s.target.classList;if(n.contains("highlightIcon")){if(!this.isLongPress){const e="high"===t.extendedProps.status;this.$store.dispatch("homework/setHigh",{props:{id:t.id,status:e?"":"high",color:e?"":this.highlightColor},update:!0})}return}if(n.contains("deleteIcon"))return this.$store.dispatch("homework/deleteEvent",{id:t.id,update:!0}),void this.setTrashButtonVisibility();const i="done"===t.extendedProps.status;this.$store.dispatch("homework/setDone",{props:{id:t.id,status:i?"":"done"},update:!0})},onLongPress(e){this.isLongPress=!0;const t=new R.AM(e.target,{content:"<div class='box red'></div><div class='box orange'></div><div class='box yellow'></div>",placement:"top",trigger:"manual",html:!0,container:"body"});t.show();const s=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),n=s?"touchstart":"mousedown",i=s=>{t.dispose(),s.target.classList.contains("box")&&this.changeSavedColor(s,e.target.id),this.isLongPress=!1,document.removeEventListener(n,i)};document.addEventListener(n,i,{once:!0})},getEvents(){return Promise.resolve(this.events)},onScroll(){window.scrollY>2?document.querySelector(".listView .fc-header-toolbar").classList.add("shadow"):document.querySelector(".listView .fc-header-toolbar").classList.remove("shadow")},changeView(){P.A.push("/tunniplaan")},changeSavedColor(e,t){this.highlightColor=e.target.classList[1],localStorage.setItem("high",e.target.classList[1]),this.$store.dispatch("homework/setHigh",{props:{id:t,status:"high",color:this.highlightColor},update:!0})},showSettings(){this.$store.dispatch("changeSettingsVisibility")},toggleAddEvent(){this.isAddEventVisible&&this.setTrashButtonVisibility(),this.isAddEventVisible=!this.isAddEventVisible},toggleFilter(){this.isFilterVisible=!this.isFilterVisible},toggleDelete(e){this.isDelete=!this.isDelete;const t=e.target.querySelector("span");if(t){if(this.isDelete)return t.classList.replace("fc-icon-trash","fc-icon-check");t.classList.replace("fc-icon-check","fc-icon-trash")}},setTrashButtonVisibility(){const e=this.events.some(e=>"true"===e.extendedProps.userAdded),t=document.querySelector(".fc-trash-button");if(!t)return;const s=e?"":"none";t.style.display!==s&&(t.style.display=s,!e&&this.isDelete&&this.toggleDelete({target:t}))},refetchEvents(){"visible"===document.visibilityState&&this.$store.dispatch("fetchAllEvents")}},computed:{events(){return this.$store.getters["homework/getEvents"]}},watch:{events:{handler(){this.calendar.refetchEvents()},deep:!0}},mounted(){this.calendar=this.$refs.fullCalendar.getApi(),this.setTrashButtonVisibility()},created(){window.addEventListener("visibilitychange",this.refetchEvents),window.addEventListener("scroll",this.onScroll)},beforeUnmount(){window.removeEventListener("visibilitychange",this.refetchEvents),window.removeEventListener("scroll",this.onScroll)}},V=s(1241);const O=(0,V.A)(H,[["render",r]]);var N=O}}]);
//# sourceMappingURL=867.456d68a1.js.map