"use strict";(self["webpackChunkMoois"]=self["webpackChunkMoois"]||[]).push([[14],{3014:function(e,t,n){n.r(t),n.d(t,{default:function(){return O}});var s=n(6768),i=n(4232);const o={key:0,class:"eventButton deleteIcon"},a=["id"];function r(e,t,n,r,l,d){const c=(0,s.g2)("addEvent"),h=(0,s.g2)("FullCalendar"),u=(0,s.gN)("long-press");return(0,s.uX)(),(0,s.CE)(s.FK,null,[this.isAddEventVisible?((0,s.uX)(),(0,s.Wv)(c,{key:0,onClose:this.toggleAddEvent},null,8,["onClose"])):(0,s.Q3)("",!0),(0,s.bF)(h,{class:"listView",ref:"fullCalendar",options:l.calendarOptions},{eventContent:(0,s.k6)((e=>[(0,s.Lk)("div",{class:(0,i.C4)(["event",e.event.extendedProps.color])},[(0,s.Lk)("div",{class:(0,i.C4)(["eventTitle",e.event.extendedProps.status])},(0,i.v_)(e.event.title),3),"true"===e.event.extendedProps.userAdded&&l.isDelete?((0,s.uX)(),(0,s.CE)("div",o)):"done"!==e.event.extendedProps.status?(0,s.bo)(((0,s.uX)(),(0,s.CE)("div",{key:1,id:e.event.id,class:"eventButton highlightIcon","on:onLongPress":t[0]||(t[0]=(...e)=>d.onLongPress&&d.onLongPress(...e))},null,40,a)),[[u]]):(0,s.Q3)("",!0)],2)])),_:1},8,["options"])],64)}n(4114);var l=n(3535),d=n(4273),c=n(6730),h=n(9403),u=n(7533);class v extends h.B{constructor(){super(...arguments),this.state={textId:(0,h.a5)()}}render(){let{theme:e,dateEnv:t,options:n,viewApi:s}=this.context,{cellId:i,dayDate:o,todayRange:a}=this.props,{textId:r}=this.state,l=(0,h.a_)(o,a),d=n.listDayFormat?t.format(o,n.listDayFormat):"",c=n.listDaySideFormat?t.format(o,n.listDaySideFormat):"",v=Object.assign({date:t.toDate(o),view:s,textId:r,text:d,sideText:c,navLinkAttrs:(0,h.b0)(this.context,o),sideNavLinkAttrs:(0,h.b0)(this.context,o,"day",!1)},l);return(0,u.n)(h.C,{elTag:"tr",elClasses:["fc-list-day",...(0,h.aZ)(l,e)],elAttrs:{"data-date":(0,h.bv)(o)},renderProps:v,generatorName:"dayHeaderContent",customGenerator:n.dayHeaderContent,defaultGenerator:g,classNameGenerator:n.dayHeaderClassNames,didMount:n.dayHeaderDidMount,willUnmount:n.dayHeaderWillUnmount},(t=>(0,u.n)("th",{scope:"colgroup",colSpan:3,id:i,"aria-labelledby":r},(0,u.n)(t,{elTag:"div",elClasses:["fc-list-day-cushion",e.getClass("tableCellShaded")]}))))}}function g(e){return(0,u.n)(u.FK,null,e.text&&(0,u.n)("a",Object.assign({id:e.textId,className:"fc-list-day-text"},e.navLinkAttrs),e.text),e.sideText&&(0,u.n)("a",Object.assign({"aria-hidden":!0,className:"fc-list-day-side-text"},e.sideNavLinkAttrs),e.sideText))}const f=(0,h.x)({hour:"numeric",minute:"2-digit",meridiem:"short"});class p extends h.B{render(){let{props:e,context:t}=this,{options:n}=t,{seg:s,timeHeaderId:i,eventHeaderId:o,dateHeaderId:a}=e,r=n.eventTimeFormat||f;return(0,u.n)(h.cn,Object.assign({},e,{elTag:"tr",elClasses:["fc-list-event",s.eventRange.def.url&&"fc-event-forced-url"],defaultGenerator:()=>m(s,t),seg:s,timeText:"",disableDragging:!0,disableResizing:!0}),((e,n)=>(0,u.n)(u.FK,null,y(s,r,t,i,a),(0,u.n)("td",{"aria-hidden":!0,className:"fc-list-event-graphic"},(0,u.n)("span",{className:"fc-list-event-dot",style:{borderColor:n.borderColor||n.backgroundColor}})),(0,u.n)(e,{elTag:"td",elClasses:["fc-list-event-title"],elAttrs:{headers:`${o} ${a}`}}))))}}function m(e,t){let n=(0,h.bU)(e,t);return(0,u.n)("a",Object.assign({},n),e.eventRange.def.title)}function y(e,t,n,s,i){let{options:o}=n;if(!1!==o.displayEventTime){let a,r=e.eventRange.def,l=e.eventRange.instance,d=!1;if(r.allDay?d=!0:(0,h.az)(e.eventRange.range)?e.isStart?a=(0,h.bQ)(e,t,n,null,null,l.range.start,e.end):e.isEnd?a=(0,h.bQ)(e,t,n,null,null,e.start,l.range.end):d=!0:a=(0,h.bQ)(e,t,n),d){let e={text:n.options.allDayText,view:n.viewApi};return(0,u.n)(h.C,{elTag:"td",elClasses:["fc-list-event-time"],elAttrs:{headers:`${s} ${i}`},renderProps:e,generatorName:"allDayContent",customGenerator:o.allDayContent,defaultGenerator:b,classNameGenerator:o.allDayClassNames,didMount:o.allDayDidMount,willUnmount:o.allDayWillUnmount})}return(0,u.n)("td",{className:"fc-list-event-time"},a)}return null}function b(e){return e.text}class w extends h.be{constructor(){super(...arguments),this.computeDateVars=(0,h.z)(x),this.eventStoreToSegs=(0,h.z)(this._eventStoreToSegs),this.state={timeHeaderId:(0,h.a5)(),eventHeaderId:(0,h.a5)(),dateHeaderIdRoot:(0,h.a5)()},this.setRootEl=e=>{e?this.context.registerInteractiveComponent(this,{el:e}):this.context.unregisterInteractiveComponent(this)}}render(){let{props:e,context:t}=this,{dayDates:n,dayRanges:s}=this.computeDateVars(e.dateProfile),i=this.eventStoreToSegs(e.eventStore,e.eventUiBases,s);return(0,u.n)(h.ct,{elRef:this.setRootEl,elClasses:["fc-list",t.theme.getClass("table"),!1!==t.options.stickyHeaderDates?"fc-list-sticky":""],viewSpec:t.viewSpec},(0,u.n)(h.cd,{liquid:!e.isHeightAuto,overflowX:e.isHeightAuto?"visible":"hidden",overflowY:e.isHeightAuto?"visible":"auto"},i.length>0?this.renderSegList(i,n):this.renderEmptyMessage()))}renderEmptyMessage(){let{options:e,viewApi:t}=this.context,n={text:e.noEventsText,view:t};return(0,u.n)(h.C,{elTag:"div",elClasses:["fc-list-empty"],renderProps:n,generatorName:"noEventsContent",customGenerator:e.noEventsContent,defaultGenerator:E,classNameGenerator:e.noEventsClassNames,didMount:e.noEventsDidMount,willUnmount:e.noEventsWillUnmount},(e=>(0,u.n)(e,{elTag:"div",elClasses:["fc-list-empty-cushion"]})))}renderSegList(e,t){let{theme:n,options:s}=this.context,{timeHeaderId:i,eventHeaderId:o,dateHeaderIdRoot:a}=this.state,r=S(e);return(0,u.n)(h.ch,{unit:"day"},((e,l)=>{let d=[];for(let n=0;n<r.length;n+=1){let c=r[n];if(c){let r=(0,h.bv)(t[n]),g=a+"-"+r;d.push((0,u.n)(v,{key:r,cellId:g,dayDate:t[n],todayRange:l})),c=(0,h.bR)(c,s.eventOrder);for(let t of c)d.push((0,u.n)(p,Object.assign({key:r+":"+t.eventRange.instance.instanceId,seg:t,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:!1,timeHeaderId:i,eventHeaderId:o,dateHeaderId:g},(0,h.bS)(t,l,e))))}}return(0,u.n)("table",{className:"fc-list-table "+n.getClass("table")},(0,u.n)("thead",null,(0,u.n)("tr",null,(0,u.n)("th",{scope:"col",id:i},s.timeHint),(0,u.n)("th",{scope:"col","aria-hidden":!0}),(0,u.n)("th",{scope:"col",id:o},s.eventHint))),(0,u.n)("tbody",null,d))}))}_eventStoreToSegs(e,t,n){return this.eventRangesToSegs((0,h.af)(e,t,this.props.dateProfile.activeRange,this.context.options.nextDayThreshold).fg,n)}eventRangesToSegs(e,t){let n=[];for(let s of e)n.push(...this.eventRangeToSegs(s,t));return n}eventRangeToSegs(e,t){let n,s,i,{dateEnv:o}=this.context,{nextDayThreshold:a}=this.context.options,r=e.range,l=e.def.allDay,d=[];for(n=0;n<t.length;n+=1)if(s=(0,h.o)(r,t[n]),s&&(i={component:this,eventRange:e,start:s.start,end:s.end,isStart:e.isStart&&s.start.valueOf()===r.start.valueOf(),isEnd:e.isEnd&&s.end.valueOf()===r.end.valueOf(),dayIndex:n},d.push(i),!i.isEnd&&!l&&n+1<t.length&&r.end<o.add(t[n+1].start,a))){i.end=r.end,i.isEnd=!0;break}return d}}function E(e){return e.text}function x(e){let t=(0,h.q)(e.renderRange.start),n=e.renderRange.end,s=[],i=[];while(t<n)s.push(t),i.push({start:t,end:(0,h.t)(t,1)}),t=(0,h.t)(t,1);return{dayDates:s,dayRanges:i}}function S(e){let t,n,s=[];for(t=0;t<e.length;t+=1)n=e[t],(s[n.dayIndex]||(s[n.dayIndex]=[])).push(n);return s}var C=':root{--fc-list-event-dot-width:10px;--fc-list-event-hover-bg-color:#f5f5f5}.fc-theme-standard .fc-list{border:1px solid var(--fc-border-color)}.fc .fc-list-empty{align-items:center;background-color:var(--fc-neutral-bg-color);display:flex;height:100%;justify-content:center}.fc .fc-list-empty-cushion{margin:5em 0}.fc .fc-list-table{border-style:hidden;width:100%}.fc .fc-list-table tr>*{border-left:0;border-right:0}.fc .fc-list-sticky .fc-list-day>*{background:var(--fc-page-bg-color);position:sticky;top:0}.fc .fc-list-table thead{left:-10000px;position:absolute}.fc .fc-list-table tbody>tr:first-child th{border-top:0}.fc .fc-list-table th{padding:0}.fc .fc-list-day-cushion,.fc .fc-list-table td{padding:8px 14px}.fc .fc-list-day-cushion:after{clear:both;content:"";display:table}.fc-theme-standard .fc-list-day-cushion{background-color:var(--fc-neutral-bg-color)}.fc-direction-ltr .fc-list-day-text,.fc-direction-rtl .fc-list-day-side-text{float:left}.fc-direction-ltr .fc-list-day-side-text,.fc-direction-rtl .fc-list-day-text{float:right}.fc-direction-ltr .fc-list-table .fc-list-event-graphic{padding-right:0}.fc-direction-rtl .fc-list-table .fc-list-event-graphic{padding-left:0}.fc .fc-list-event.fc-event-forced-url{cursor:pointer}.fc .fc-list-event:hover td{background-color:var(--fc-list-event-hover-bg-color)}.fc .fc-list-event-graphic,.fc .fc-list-event-time{white-space:nowrap;width:1px}.fc .fc-list-event-dot{border:calc(var(--fc-list-event-dot-width)/2) solid var(--fc-event-border-color);border-radius:calc(var(--fc-list-event-dot-width)/2);box-sizing:content-box;display:inline-block;height:0;width:0}.fc .fc-list-event-title a{color:inherit;text-decoration:none}.fc .fc-list-event.fc-event-forced-url:hover a{text-decoration:underline}';(0,h.cw)(C);const D={listDayFormat:k,listDaySideFormat:k,noEventsClassNames:h.n,noEventsContent:h.n,noEventsDidMount:h.n,noEventsWillUnmount:h.n};function k(e){return!1===e?null:(0,h.x)(e)}var L=(0,c.i1)({name:"@fullcalendar/list",optionRefiners:D,views:{list:{component:w,buttonTextKey:"list",listDayFormat:{month:"long",day:"numeric",year:"numeric"}},listDay:{type:"list",duration:{days:1},listDayFormat:{weekday:"long"}},listWeek:{type:"list",duration:{weeks:1},listDayFormat:{weekday:"long"},listDaySideFormat:{month:"long",day:"numeric",year:"numeric"}},listMonth:{type:"list",duration:{month:1},listDaySideFormat:{weekday:"long"}},listYear:{type:"list",duration:{year:1},listDaySideFormat:{weekday:"long"}}}});const T=["mousedown","touchstart"],I=["mouseup","mouseleave","touchend"],P=500,A={mounted(e){let t=null;const n=n=>{"mousedown"===n.type&&0!==n.button||(t=setTimeout((()=>{e.dispatchEvent(new CustomEvent("onLongPress",{detail:n}))}),P))},s=e=>{t&&(clearTimeout(t),t=null)};T.forEach((t=>e.addEventListener(t,n,{passive:!0}))),I.forEach((t=>e.addEventListener(t,s,{passive:!0}))),e._cleanup=()=>{T.forEach((t=>e.removeEventListener(t,n))),I.forEach((t=>e.removeEventListener(t,s)))}},unmounted(e){e._cleanup()}};var R=n(4578),H=n(9325),V={name:"kodutood",components:{FullCalendar:l.A,addEvent:(0,s.$V)((()=>n.e(420).then(n.bind(n,4420))))},directives:{longPress:A},data(){return{isAddEventVisible:!1,isLongPress:!1,isDelete:!1,highlightColor:localStorage.getItem("high")&&/(red|orange|yellow)/.test(localStorage.getItem("high"))?localStorage.getItem("high"):"red",calendarOptions:{plugins:[L],customButtons:{trash:{text:"Kustuta",icon:"trash",click:this.toggleDelete},addEvent:{text:"Lisa",icon:"addEvent",click:this.toggleAddEvent},tunniplaan:{text:"Tunniplaan",click:this.changeView},settings:{text:"Seaded",icon:"settings ",click:this.showSettings}},views:{kodutood:{type:"list"}},locale:d.A,defaultTimedEventDuration:0,events:this.getEvents,lazyFetching:!0,progressiveEventRendering:!0,contentHeight:"auto",initialView:"kodutood",eventsSet:this.setVisibleRange,eventClick:this.onEventClick,headerToolbar:{left:"",center:"",right:"addEvent trash tunniplaan settings"}}}},methods:{setVisibleRange(e){if(0===e.length)return;const t=e.map((e=>new Date(new Date(e.start).toISOString().split("T")[0]))),n=new Date(Math.min(...t));let s=new Date(Math.max(...t));s.setDate(s.getDate()+2),this.calendar.setOption("visibleRange",{start:n.toISOString().split("T")[0],end:s.toISOString().split("T")[0]})},onEventClick(e){const{event:t,jsEvent:n}=e,s=n.target.classList;if(s.contains("highlightIcon")){if(!this.isLongPress){const e="high"===t.extendedProps.status;this.$store.dispatch("homework/setHigh",{props:{id:t.id,status:e?"":"high",color:e?"":this.highlightColor},update:!0})}return}if(s.contains("deleteIcon"))return this.$store.dispatch("homework/deleteEvent",{id:t.id,update:!0}),void this.setTrashButtonVisibility();const i="done"===t.extendedProps.status;this.$store.dispatch("homework/setDone",{props:{id:t.id,status:i?"":"done"},update:!0})},onLongPress(e){this.isLongPress=!0;const t=new R.AM(e.target,{content:"<div class='box red'></div><div class='box orange'></div><div class='box yellow'></div>",placement:"top",trigger:"manual",html:!0,container:"body"});t.show();const n=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),s=n?"touchstart":"mousedown",i=n=>{t.dispose(),n.target.classList.contains("box")&&this.changeSavedColor(n,e.target.id),this.isLongPress=!1,document.removeEventListener(s,i)};document.addEventListener(s,i,{once:!0})},getEvents(){return Promise.resolve(this.events)},onScroll(){window.scrollY>2?document.querySelector(".listView .fc-header-toolbar").classList.add("shadow"):document.querySelector(".listView .fc-header-toolbar").classList.remove("shadow")},changeView(){H.A.push("/tunniplaan")},changeSavedColor(e,t){this.highlightColor=e.target.classList[1],localStorage.setItem("high",e.target.classList[1]),this.$store.dispatch("homework/setHigh",{props:{id:t,status:"high",color:this.highlightColor},update:!0})},showSettings(){this.$store.dispatch("changeSettingsVisibility")},toggleAddEvent(){this.isAddEventVisible&&this.setTrashButtonVisibility(),this.isAddEventVisible=!this.isAddEventVisible},toggleDelete(e){this.isDelete=!this.isDelete;const t=e.target.querySelector("span");if(t){if(this.isDelete)return t.classList.replace("fc-icon-trash","fc-icon-check");t.classList.replace("fc-icon-check","fc-icon-trash")}},setTrashButtonVisibility(){const e=this.events.some((e=>"true"===e.extendedProps.userAdded)),t=document.querySelector(".fc-trash-button");if(!t)return;const n=e?"":"none";t.style.display!==n&&(t.style.display=n,!e&&this.isDelete&&this.toggleDelete({target:t}))},refetchEvents(){"visible"===document.visibilityState&&this.$store.dispatch("fetchAllEvents")},addEventPreload(e){e.target.closest(".fc-addEvent-button")&&(window.removeEventListener("mouseover",this.addEventPreload),n.e(420).then(n.bind(n,4420)))},tunniplaanPreload(e){e.target.closest(".fc-tunniplaan-button")&&(window.removeEventListener("mouseover",this.tunniplaanPreload),Promise.all([n.e(507),n.e(494)]).then(n.bind(n,8507)))}},computed:{events(){return this.$store.getters["homework/getEvents"]}},watch:{events:{handler(){this.calendar.refetchEvents()},deep:!0}},mounted(){this.calendar=this.$refs.fullCalendar.getApi(),this.setTrashButtonVisibility()},created(){window.addEventListener("mouseover",this.addEventPreload),window.addEventListener("mouseover",this.tunniplaanPreload),window.addEventListener("visibilitychange",this.refetchEvents),window.addEventListener("scroll",this.onScroll)},beforeUnmount(){window.removeEventListener("mouseover",this.addEventPreload),window.removeEventListener("mouseover",this.tunniplaanPreload),window.removeEventListener("visibilitychange",this.refetchEvents),window.removeEventListener("scroll",this.onScroll)}},F=n(1241);const N=(0,F.A)(V,[["render",r]]);var O=N}}]);
//# sourceMappingURL=14.c3b51c93.js.map